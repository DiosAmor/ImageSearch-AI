<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="í´ë¼ìš°ë“œ ì´ë¯¸ì§€ ëª©ë¡ì„ í™•ì¸í•˜ê³  ì¸ì¦ì´ í•„ìš”í•œ ê²½ìš° ì•ˆë‚´ë¥¼ ë°›ìŠµë‹ˆë‹¤." />
    <meta name="keywords" content="í´ë¼ìš°ë“œ, ì´ë¯¸ì§€, êµ¬ê¸€ ë“œë¼ì´ë¸Œ, ì›ë“œë¼ì´ë¸Œ, ì¸ì¦" />
    <title>í´ë¼ìš°ë“œ ì´ë¯¸ì§€ ì„ íƒ</title>
    {% load static %}
    <link rel="stylesheet"
          href="{% static 'imagesearch_gemini/css/styles.css' %}" />
  </head>
  <body>
    <h1>{{ cloud | title }} í´ë¼ìš°ë“œ ì´ë¯¸ì§€ ì„ íƒ</h1>
    <form method="get" class="cloud-connect-form">
      <label for="cloud">í´ë¼ìš°ë“œ ì¢…ë¥˜:</label>
      <select name="cloud" id="cloud">
        <option value="google" {% if cloud == "google" %}selected{% endif %}>Google Drive</option>
        <option value="onedrive" {% if cloud == "onedrive" %}selected{% endif %}>OneDrive</option>
      </select>
      <label for="cloud_email">ì´ë©”ì¼:</label>
      <input type="email"
             name="cloud_email"
             id="cloud_email"
             value="{{ cloud_email|default_if_none:'' }}"
             required>
      <button type="submit">ì—°ê²°</button>
    </form>
    {% if message %}<div class="message">{{ message|safe }}</div>{% endif %}
    <div class="current-path">
      <a href="?cloud={{ cloud }}&cloud_email={{ cloud_email }}">ë£¨íŠ¸</a>
      {% if parent_id %}
        <span class="path-separator">></span>
        <span>{{ folder_name }}</span>
      {% endif %}
    </div>
    <form method="post">
      {% csrf_token %}
      <input type="hidden" name="cloud" value="{{ cloud }}" />
      <input type="hidden" name="cloud_email" value="{{ cloud_email }}" />
      <input type="hidden" name="parent_id" value="{{ parent_id }}" />
      <div class="file-explorer">
        <div class="file-explorer-header">
          <div class="file-name">ì´ë¦„</div>
          <div class="file-date">ìˆ˜ì •ëœ ë‚ ì§œ</div>
          <div class="file-type">íŒŒì¼ í˜•ì‹</div>
          <div class="file-size">í¬ê¸°</div>
        </div>
        <div class="file-explorer-body">
          <!-- í´ë” ëª©ë¡ -->
          {% for folder in folders %}
            <div class="file-explorer-item folder">
              <a href="?cloud={{ cloud }}&cloud_email={{ cloud_email }}&parent_id={{ folder.id }}{% if folder.shared %}&is_shared=1&drive_id={{ folder.drive_id }}{% endif %}"
                 class="file-name{% if folder.shared %} shared-folder{% endif %}">
                <span class="folder-icon">
                  {% if folder.shared %}
                    ğŸ”—
                  {% else %}
                    ğŸ“
                  {% endif %}
                </span> {{ folder.name }}
              </a>
              <div class="file-date">{{ folder.date }}</div>
              <div class="file-type">{{ folder.type }}</div>
              <div class="file-size"></div>
            </div>
          {% endfor %}
          <!-- ì´ë¯¸ì§€ ëª©ë¡ -->
          {% for img in images %}
            <div class="file-explorer-item">
              <label class="file-explorer-row">
                <input type="checkbox" name="selected_images" value="{{ img.id }}" />
                <div class="file-name">
                  <span class="file-icon">ğŸ–¼ï¸</span>
                  <a href="{{ img.url }}" target="_blank">{{ img.name }}</a>
                </div>
                <div class="file-date">{{ img.date }}</div>
                <div class="file-type">{{ img.type }}</div>
                <div class="file-size">{{ img.size }}</div>
              </label>
            </div>
          {% endfor %}
          {% if not folders and not images %}
            <div class="file-explorer-item">
              <div class="file-name">ì´ë¯¸ì§€ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</div>
              <div class="file-date"></div>
              <div class="file-type"></div>
              <div class="file-size"></div>
            </div>
          {% endif %}
        </div>
      </div>
      <div class="action-buttons">
        {% if parent_id and parent_info.parent_id %}
          <a href="?cloud={{ cloud }}&cloud_email={{ cloud_email }}&parent_id={{ parent_info.parent_id }}{% if parent_info.is_shared %}&is_shared=1{% endif %}{% if parent_info.drive_id %}&drive_id={{ parent_info.drive_id }}{% endif %}"
             class="back-button button">â† ìƒìœ„ í´ë”ë¡œ</a>
        {% endif %}
        <button type="submit">ì„ íƒí•œ ì´ë¯¸ì§€ ì €ì¥</button>
      </div>
    </form>
    {% if parent_info.error %}<div class="message">{{ parent_info.error }}</div>{% endif %}
  </body>
</html>
